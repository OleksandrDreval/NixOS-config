**Конфігурація безпеки NixOS (v24.11)**
Конфігурація використовує підхід "defense in depth" з кількома шарами захисту, що робить її придатною для роботи з конфіденційними даними або в небезпечних мережевих середовищах.

1. **Захист завантажувального процесу** (рядки 11-58):
   - Шифрування диска LUKS з systemd-initrd (рядок 28)
   - Обмеження EFI-змін (рядок 22)
   - Підпис модулів ядра (рядок 47)
   - Використання останніх ядер Linux (рядок 32)

2. **Мережева безпека** (рядки 83-145):
   - Строгий фаєрвол з правилами проти сканування портів (рядки 120-139)
   - Використання DNS-over-TLS (1.1.1.1, 8.8.8.8)
   - Блокування ICMP-пінгів (рядки 121-122)
   - Обмеження IPv6-тимчасових адрес (рядок 86)

3. **Захист ядра** (рядки 34-55, 59-78):
   - Параметри захисту від Spectre/Meltdown (рядки 37-46)
   - Використання KPTI/SMAP/SMEP (рядки 50, 297)
   - Обмеження debugfs (рядок 52)
   - Налаштування sysctl для мінімізації атак (рядки 60-78)

4. **Системний аудит** (рядки 283-290):
   - Auditd для відстеження:
     - Виконання процесів (рядок 286)
     - Мережеві з'єднання (рядки 287-288)
   - Журналювання systemd з шифруванням (рядки 178-192)

5. **Обмеження користувачів** (рядки 253-317):
   - SELinux у режимі enforcement (рядки 313-316)
   - Обмеження namespace (рядок 296)
   - PAM-обмеження ресурсів (рядки 307-310)
   - Захист sudo (рядки 271-279)

6. **Віртуалізація з підвищеною безпекою** (рядки 369-401):
   - Libvirt з SELinux-профілями (рядок 377)
   - Seccomp-фільтри (рядок 387)
   - Обмежений доступ до пристроїв (рядки 382-386)

7. **Захист пакетної системи** (рядки 325-333):
   - Sandbox-збірка пакетів
   - Обмеження доступу до nix-daemon
   - Використання flakes для відтворюваності

**Додаткові практики безпеки:**
- Вимкнена мультипотоковість (рядок 298)
- Обмеження ptrace (рядок 71)
- Захист від DMA-атак (рядок 299)
- Використання Secure Boot інструментів (sbctl у рядку 351)

